# Overview
- Tags: `picoCTF 2023` `Web Exploitation` `XXE`
- `100 points`

# Description
The web project was rushed and no security assessment was done. Can you read the /etc/passwd file? 

Additional details will be available after launching your challenge instance.

# Hints
XML external entity injection

# Getting Started

There are a few things to point out: 
* First is that this challenge involves XXE, which is XML external entity injection. 

* Second is in order to complete this challenge and injection, you must use BurpSuite. 

[Burpsuite](https://portswigger.net/burp) is a common tool used for penetration testing and application security testing. 

[PortSwigger](https://portswigger.net/web-security/xxe) has a good page describing almost exactly this challenge. This is the XXE payload that is on the PortSwigger site linked above:

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<stockCheck><productId>&xxe;</productId></stockCheck>
```

# Setting Up BurpSuite

To complete the injection, you must setup BurpSuite. Use the steps below to complete the setup:

Steps in BurpSuite:

* Create a Temporary project by pressing "Next" with the default configurations.

![image](https://user-images.githubusercontent.com/91398631/232889427-3a7e912a-4f38-4273-8bf0-507f8758507b.png)

* Then click "Start Burp" with Burp Defaults.

![image](https://user-images.githubusercontent.com/91398631/232889471-ea12a95d-3faf-4613-889a-ac54b5f96c3a.png)

* Then click the proxy tab.

![image](https://user-images.githubusercontent.com/91398631/232889613-e2e0dd3f-8da5-453c-8b58-87e58930e75c.png)

* Then open the BurpSuite browser. Anything you do in that browser can be seen and can manipulate incoming packets.

![image](https://user-images.githubusercontent.com/91398631/232889733-f9593a72-1521-4e55-8f53-85a2ef77b65b.png)

* Once you're in the BurpSuite web browser, paste the link from the challenge `http://saturn.picoctf.net:55346/` 

# Solution

In BurpSuite, click `Intercept is off` to turn the intercept on. This will stop all traffic so you can inspect the packets before they are sent.

![image](https://user-images.githubusercontent.com/91398631/232891071-e480c306-20fe-49fe-adaf-bf746afe8b60.png)

Click `Forward` at the top to forward the request. Click the `Details` button under any of the three options to see XML in the intercepted packet.

![image](https://github.com/Bsnookie9/picoCTF-2023-WriteUp/assets/106827110/28faa6bd-7fae-4b1a-a6dc-77bbb5cc677e)

Now look at the earlier XXE Payload

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<stockCheck><productId>&xxe;</productId></stockCheck>
```

The most important part is this: `<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>`. Paste this under the `<?xml version="1.0" encoding="UTF-8"?>`. 

Now add `&xxe;` before the 1 to show the output of the injection. 

![image](https://github.com/Bsnookie9/picoCTF-2023-WriteUp/assets/106827110/540e1413-95bf-4731-abc8-6cb0c0a912dc)

Then click `Forward` to forward the packet and you will see the flag on the bottom of the page.

![image](https://github.com/Bsnookie9/picoCTF-2023-WriteUp/assets/106827110/7d6d5d21-6403-4865-a1ae-6adf749da511)

Flag: `picoCTF{XML_3xtern@l_3nt1t1ty_e5f02dbf}`
